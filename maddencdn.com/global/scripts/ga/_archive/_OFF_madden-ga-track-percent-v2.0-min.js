/**
 * v2.0 - Copyright 2015 Madden Media - All rights reserved.
 *
 * Advanced Google Analytics tracking script that tracks scroll distance and fires
 *	the specified distances as analytics events.
 *	
 * Requires Google Analytics or Tag Manager. This script will determine which 
 *	tracking object (GTM, Universal, Legacy, etc.) appears to be present and will 
 *	adjust tracking calls based on this.
 */
!function(){function e(){return h}function t(e){var t=document.documentElement.scrollHeight,n=Math.floor(t*e);return n}function n(e,t){var n="";return n=t?this.settings.readingEventLabelPrefix+e+" pixels":.001>e?this.settings.readingEventLabelPrefix+"0%":this.settings.readingEventLabelPrefix+100*e+"%"}function s(e,t,n,i){if(!this.DEBUG_MODE){var s=null;null!=this.settings.gtmDataLayerName?s=this.settings.gtmDataLayerName:"undefined"!=typeof dataLayer&&"function"==typeof dataLayer.push&&(s=dataLayer),null!=s&&"function"==typeof s.push&&s.push({event:this.settings.gtmEventName,eventCategory:e,eventAction:t,eventLabel:n,eventValue:i}),"undefined"!=typeof _gaq&&("undefined"!=typeof pageTracker?pageTracker._trackEvent(e,t,n,i):(_gaq.push(["_trackEvent",e,t,n,i]),_gaq.push(["pageTracker._trackEvent",e,t,n,i]))),"undefined"!=typeof ga&&ga("send",{hitType:"event",eventCategory:e,eventAction:t,eventLabel:n,eventValue:i})}}function a(){for(i=0;i<this.settings.readerTrackPercents.length;i++)this.readerLocations[i]=t(this.settings.readerTrackPercents[i]),c("LOCATION: "+this.settings.readerTrackPercents[i]+" ("+this.readerLocations[i]+" / "+document.documentElement.scrollHeight+")")}function r(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(g,this.CALLBACK_DELAY)}function d(e,t){for(o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function c(e){this.settings.logEventsToConsole&&console.log(e)}function l(e){if(window.jQuery)jQuery(document).ready(function(){e()});else if("function"!=typeof window.onload)window.onload=e;else{var t=window.onload;window.onload=function(){t&&t(),e()}}}var h=!1;MMGAReadPercent=function(){this.DEBUG_MODE=!1,this.CALLBACK_DELAY=100,this.timer=0,this.readerLastPassed=0,this.isScrolling=!1,this.endContent=!1,this.didComplete=!1,this.readerLocations=[],this.startTime=(new Date).getTime(),this.totalTime=0;var e={readerTrackPercents:[1e-4,.25,.5,.75],fireReadCompleteEvent:!0,readingEventLabelPrefix:"Reading ",gtmEventName:"ScrollDistance",gtmDataLayerName:null,firePixelDistanceEvents:!1,logEventsToConsole:!1};arguments[0]&&"object"==typeof arguments[0]?this.settings=d(e,arguments[0]):this.settings=d(e,[]),h=!0,a()};var g=function(){if("undefined"!=typeof this.readerLocations){var e=window.scrollY||window.pageYOffset,t=window.innerHeight+e,a=document.documentElement.scrollHeight,r=new Date,o=Math.round((r.getTime()-this.startTime)/1e3);for(i=this.readerLastPassed;i<this.readerLocations.length;i++)if(t>=this.readerLocations[i]&&o>0){var d=n(this.settings.readerTrackPercents[i],!1);if(s(this.settings.readingEventLabelPrefix,d,location.pathname,o),this.settings.firePixelDistanceEvents){var l=n(this.readerLocations[i],!0);s(this.settings.readingEventLabelPrefix,l,location.pathname,o)}c(this.settings.readingEventLabelPrefix+this.readerLocations[i]+" /  "+d+" / "+o),this.readerLastPassed=i+1}if(this.settings.fireReadCompleteEvent&&t>=a&&!this.didComplete){r=new Date;var r=new Date,o=Math.round((r.getTime()-this.startTime)/1e3),d=n(1,!1);if(s(this.settings.readingEventLabelPrefix,d,location.pathname,o),this.settings.firePixelDistanceEvents){var l=n(a,!0);s(this.settings.readingEventLabelPrefix,l,location.pathname,o)}c(this.settings.readingEventLabelPrefix+d+" / "+o),this.didComplete=!0}}};l(function(){if(!e()){MMGAReadPercent()}}),window.addEventListener?window.addEventListener("resize",a):window.attachEvent("onresize",a),window.addEventListener?window.addEventListener("scroll",r):window.attachEvent("onscroll",r)}(),"undefined"==typeof console&&(console={},console.log=function(){});
