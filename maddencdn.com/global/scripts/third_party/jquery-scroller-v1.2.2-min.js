/**
 * FTScroller: touch and mouse-based scrolling for DOM elements larger than their containers.
 *
 * While this is a rewrite, it is heavily inspired by two projects:
 * 1) Uxebu TouchScroll (https://github.com/davidaurelio/TouchScroll), BSD licensed:
 *    Copyright (c) 2010 uxebu Consulting Ltd. & Co. KG
 *    Copyright (c) 2010 David Aurelio
 * 2) Zynga Scroller (https://github.com/zynga/scroller), MIT licensed:
 *    Copyright 2011, Zynga Inc.
 *    Copyright 2011, Deutsche Telekom AG
 *
 * Includes CubicBezier:
 *
 * Copyright (C) 2008 Apple Inc. All Rights Reserved.
 * Copyright (C) 2010 David Aurelio. All Rights Reserved.
 * Copyright (C) 2010 uxebu Consulting Ltd. & Co. KG. All Rights Reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY APPLE INC., DAVID AURELIO, AND UXEBU
 * CONSULTING LTD. & CO. KG ``AS IS'' AND ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL APPLE INC. OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
 * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 * @copyright The Financial Times Ltd [All rights reserved]
 * @codingstandard ftlabs-jslint
 * @version 0.3.5
 */
/**
 * @license FTScroller is (c) 2012 The Financial Times Ltd [All rights reserved] and licensed under the MIT license.
 *
 * Inspired by Uxebu TouchScroll, (c) 2010 uxebu Consulting Ltd. & Co. KG and David Aurelio, which is BSD licensed (https://github.com/davidaurelio/TouchScroll)
 * Inspired by Zynga Scroller, (c) 2011 Zynga Inc and Deutsche Telekom AG, which is MIT licensed (https://github.com/zynga/scroller)
 * Includes CubicBezier, (c) 2008 Apple Inc [All rights reserved], (c) 2010 David Aurelio and uxebu Consulting Ltd. & Co. KG. [All rights reserved], which is 2-clause BSD licensed (see above or https://github.com/davidaurelio/TouchScroll).
 */

/*jslint nomen: true, vars: true, browser: true, continue: true, white: true*/
/*globals FTScrollerOptions*/

var FTScroller,CubicBezier;(function(){"use strict";var e,t,n,r,i,s,o,u,a;if(document.createElement("div").style.transform!==undefined){e="";t="";n="transform"}else if(window.opera&&Object.prototype.toString.call(window.opera)==="[object Opera]"){e="-o-";t="O";n="OTransform"}else if(document.documentElement.style.MozTransform!==undefined){e="-moz-";t="Moz";n="MozTransform"}else if(document.documentElement.style.webkitTransform!==undefined){e="-webkit-";t="webkit";n="-webkit-transform"}else if(typeof navigator.cpuClass==="string"){e="-ms-";t="ms";n="-ms-transform"}if("pointerEnabled"in window.navigator){r=false;u=window.navigator.pointerEnabled;i="setPointerCapture";s="releasePointerCapture";o="lostpointercapture";a="touch"}else if("msPointerEnabled"in window.navigator){r=true;u=window.navigator.msPointerEnabled;i="msSetPointerCapture";s="msReleasePointerCapture";o="MSLostPointerCapture";a=2}var f=false;var l=false;if("propertyIsEnumerable"in window||"hasOwnProperty"in window.document){l=!u&&(window.propertyIsEnumerable("ontouchstart")||window.document.hasOwnProperty("ontouchstart"))}var c=false;if("hasOwnProperty"in window){c=!window.hasOwnProperty("ArrayBuffer")}var h=window.Selection&&window.Selection.prototype.removeAllRanges;if(!c&&document.createElement("div").style[t+(t?"P":"p")+"erspective"]===undefined){c=true}var p=t+(t?"T":"t")+"ransform";var d=t+(t?"T":"t")+"ransition";var v=c?"translate(":"translate3d(";var m={x:"",y:"0,"};var g={x:",0"+(c?")":",0)"),y:c?")":",0)"};var y=.998;var b=.01;(function(){var t=document.getElementsByTagName("head")[0]||document.documentElement;var n=document.createElement("style");var r;var i;n.type="text/css";if(c){r=e+"transform-style: preserve-3d;"}else{r=e+"transform: translateZ(0);"}i=[".ftscroller_container { overflow: hidden; position: relative; max-height: 100%; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); -ms-touch-action: none }",".ftscroller_hwaccelerated { "+r+" }",".ftscroller_x, .ftscroller_y { position: relative; min-width: 100%; min-height: 100%; overflow: hidden }",".ftscroller_x { display: inline-block }",".ftscroller_scrollbar { pointer-events: none; position: absolute; width: 5px; height: 5px; border: 1px solid rgba(255, 255, 255, 0.3); -webkit-border-radius: 3px; border-radius: 6px; opacity: 0; "+e+"transition: opacity 350ms; z-index: 10; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box }",".ftscroller_scrollbarx { bottom: 2px; left: 2px }",".ftscroller_scrollbary { right: 2px; top: 2px }",".ftscroller_scrollbarinner { height: 100%; background: #000; -webkit-border-radius: 2px; border-radius: 4px / 6px }",".ftscroller_scrollbar.active { opacity: 0.5; "+e+"transition: none; -o-transition: all 0 none }"];if(n.styleSheet){n.styleSheet.cssText=i.join("\n")}else{n.appendChild(document.createTextNode(i.join("\n")))}t.insertBefore(n,t.firstChild)})();FTScroller=function(c,w){var E;var S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt;var wt={scrollbars:true,scrollingX:true,scrollingY:true,scrollBoundary:1,scrollResponseBoundary:1,alwaysScroll:false,contentWidth:undefined,contentHeight:undefined,snapping:false,snapSizeX:undefined,snapSizeY:undefined,paginatedSnap:false,bouncing:true,flinging:true,updateOnChanges:true,updateOnWindowResize:false,baseAlignments:{x:-1,y:-1},windowScrollingActiveFlag:undefined,hwAccelerationClass:"ftscroller_hwaccelerated",enableRequestAnimationFrameSupport:true,maxFlingDuration:1e3,disabledInputMethods:{mouse:false,touch:false,scroll:false},scrollingClassName:undefined,flingBezier:new CubicBezier(.103,.389,.307,.966),bounceDecelerationBezier:new CubicBezier(0,.5,.5,1),bounceBezier:new CubicBezier(.7,0,.9,.6)};var Et;var St=this;var xt=c;var Tt;var Nt;var Ct={x:null,y:null};var kt={x:null,y:null};var Lt={container:{x:null,y:null},content:{x:null,y:null,rawX:null,rawY:null},scrollEnd:{x:null,y:null}};var At={x:false,y:false,userX:false,userY:false};var Ot={x:0,y:0};var Mt={x:0,y:0};var _t={x:0,y:0};var Dt=false;var Pt=0;var Ht=false;var Bt=false;var jt=false;var Ft=false;var It={x:0,y:0};var qt={x:0,y:0};var Rt={x:0,y:0};var Ut={x:null,y:null};var zt=false;var Wt=[];var Xt=false;var Vt={};var $t={x:true,y:true};var Jt={x:0,y:0,t:0};var Kt={x:0,y:0};var Qt=[];var Gt=false;var Yt=false;var Zt=false;var en=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||false;var tn=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||false;var nn={scrollstart:[],scroll:[],scrollend:[],segmentwillchange:[],segmentdidchange:[],reachedstart:[],reachedend:[],scrollinteractionend:[]};var rn;if(typeof FTScrollerOptions==="object"&&FTScrollerOptions){for(E in FTScrollerOptions){if(FTScrollerOptions.hasOwnProperty(E)&&wt.hasOwnProperty(E)){wt[E]=FTScrollerOptions[E]}}}if(w){for(E in w){if(w.hasOwnProperty(E)&&wt.hasOwnProperty(E)){wt[E]=w[E]}}if(w.hasOwnProperty("snapSizeX")&&!isNaN(w.snapSizeX)){At.userX=At.x=w.snapSizeX}if(w.hasOwnProperty("snapSizeY")&&!isNaN(w.snapSizeY)){At.userY=At.y=w.snapSizeY}if(w.contentWidth&&w.contentHeight){w.updateOnChanges=false}}wt.scrollResponseBoundary=Math.min(wt.scrollBoundary,wt.scrollResponseBoundary);if(wt.scrollingX){Vt.x=true}if(wt.scrollingY){Vt.y=true}en=wt.enableRequestAnimationFrameSupport&&en;tn=en&&tn;S=function(t){var n,r;rt(false);nt();if(Gt){window.clearTimeout(Gt);Gt=false}for(n=0,r=Wt.length;n<r;n=n+1){window.clearTimeout(Wt[n])}Wt.length=0;if(t&&xt){while(Nt.firstChild){xt.appendChild(Nt.firstChild)}xt.removeChild(Tt)}xt=null;Tt=null;Nt=null;Ct.x=null;Ct.y=null;kt.x=null;kt.y=null;for(n in nn){if(nn.hasOwnProperty(n)){nn[n].length=0}}if(f&&f===St){f=false;if(wt.windowScrollingActiveFlag){window[wt.windowScrollingActiveFlag]=false}}};x=function(t,n){At.userX=t;At.userY=n;At.x=t;At.y=n;Lt.content.x=Math.ceil(Lt.content.rawX/t)*t;Lt.content.y=Math.ceil(Lt.content.rawY/n)*n;Lt.scrollEnd.x=Lt.container.x-Lt.content.x;Lt.scrollEnd.y=Lt.container.y-Lt.content.y;W();H();V(true)};T=function(t,n,r){var i,s,o,u,a=0,f={};M(Date.now());o={x:-t,y:-n};for(u in Vt){if(Vt.hasOwnProperty(u)){i=o[u];if(i===false){continue}i=Math.min(0,Math.max(Lt.scrollEnd[u],i));if(wt.snapping&&At[u]){i=Math.round(i/At[u])*At[u]}s=r||0;if(s===true){s=Math.sqrt(Math.abs(It[u]-i))*20}$(u,i,s);f[u]=i;a=Math.max(a,s)}}if(It.x!==o.x||It.y!==o.y){Xt=true;Q("scrollstart",J());Q("scroll",J())}if(a){Wt.push(setTimeout(function(){var e;for(e in f){if(f.hasOwnProperty(e)){qt[e]=f[e]}}_()},a))}else{_()}};N=function(t,n,r){T(parseFloat(t)-It.x,parseFloat(n)-It.y,r)};C=function(t,n,r){w.contentWidth=t||w.contentWidth;w.contentHeight=n||w.contentHeight;z(!!r)};k=function(t,n){if(!nn.hasOwnProperty(t)){return false}nn[t].push(n);return true};L=function(t,n){var r;if(!nn.hasOwnProperty(t)){return false}for(r=nn[t].length;r>=0;r=r-1){if(nn[t][r]===n){nn[t].splice(r,1)}}return true};A=function(t,n,r,i){var s=Ft;if(r<=0){r=Date.now()}if(wt.windowScrollingActiveFlag&&window[wt.windowScrollingActiveFlag]){return false}if(s){D()}else{zt=false}Jt.x=t;Jt.y=n;Jt.t=r;Rt.x=qt.x;Rt.y=qt.y;Qt.length=0;Qt.push({x:t,y:n,t:r});if(s){O(t,n,r,i,s)}return true};O=function(t,n,r,i,s){var o,u,a;var l=false;var c={x:t-Jt.x,y:n-Jt.y};if(r<=0){r=Date.now()}Rt.x=It.x+c.x;Rt.y=It.y+c.y;if(!Bt){if(f&&f!==St){u=true}else if(wt.windowScrollingActiveFlag&&window[wt.windowScrollingActiveFlag]){u=true}if(u){yt();Dt=false;if(jt){nt();if(!H(true)){_(true)}}return}}if(!jt){a=Z(Rt);if(wt.bouncing||s||$t.x&&c.x&&a.x<0||$t.y&&c.y&&a.y<0){i.preventDefault()}if(!s&&(!$t.x||Math.abs(c.x)<wt.scrollResponseBoundary)&&(!$t.y||Math.abs(c.y)<wt.scrollResponseBoundary)){return}if(!wt.bouncing&&!s&&(!$t.x||!c.x||a.x>0)&&(!$t.y||!c.y||a.y>0)){zt=true;return}et();jt=true;Xt=true;Ft=true;l=true}else{i.preventDefault()}if(!Bt){if(s&&wt.snapping||$t.x&&Math.abs(c.x)>=wt.scrollBoundary||$t.y&&Math.abs(c.y)>=wt.scrollBoundary){Bt=true;f=St;if(wt.windowScrollingActiveFlag){window[wt.windowScrollingActiveFlag]=St}Q("scrollstart",J())}}if(Bt){gt()}if(h){window.getSelection().removeAllRanges()}F();if(l){if(wt.scrollingClassName){Tt.className+=" "+wt.scrollingClassName}if(wt.scrollbars){for(o in $t){if($t.hasOwnProperty(o)){kt[o].className+=" active"}}}}Qt.push({x:t,y:n,t:r});if(Qt.length>30){Qt.splice(0,15)}};M=function(t,n){yt();Dt=false;nt();Q("scrollinteractionend",{});if(!Bt){if(!H(true)&&jt){_(true)}return}Qt[Qt.length-1].t=t;Bt=false;jt=false;f=false;if(wt.windowScrollingActiveFlag){window[wt.windowScrollingActiveFlag]=false}zt=true;if(n){n.preventDefault()}if(!P()&&!H()){_()}};_=function(t){var n,r,i,s,o;Ft=false;jt=false;if(wt.scrollingClassName){o=new RegExp("(?:^|\\s)"+wt.scrollingClassName+"(?!\\S)","g");Tt.className=Tt.className.replace(o,"")}if(wt.scrollbars){for(i in $t){if($t.hasOwnProperty(i)){kt[i].className=kt[i].className.replace(/ ?active/g,"")}}}It.x=qt.x;It.y=qt.y;s=J();if(!t){Q("scroll",s);V(true)}s.cancelled=t;Q("scrollend",s);for(i in $t){if($t.hasOwnProperty(i)){Ct[i].style[d]="";if(wt.scrollbars){kt[i].style[d]=""}}}for(n=0,r=Wt.length;n<r;n=n+1){window.clearTimeout(Wt[n])}Wt.length=0};D=function(){var t,n,r;Ft=false;X();for(t in $t){if($t.hasOwnProperty(t)){$(t,It[t],16,wt.bounceDecelerationBezier)}}V(false);for(n=0,r=Wt.length;n<r;n=n+1){window.clearTimeout(Wt[n])}Wt.length=0};P=function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,w,E,S,x;var T=0;var N=false;var C={};if(Qt.length===1||!wt.flinging||Dt==="scrollwheel"){return false}for(n in $t){if($t.hasOwnProperty(n)){h=350;c=0;d=false;p=false;w=undefined;m=wt.flingBezier;s=Qt[Qt.length-1];o=Qt[Qt.length-2];for(t=Qt.length-3;t>=0;t=t-1){if(s.t-Qt[t].t>100){break}o=Qt[t]}r=s.t-o.t;if(!r){r=16}i=(s[n]-o[n])/r;if(Math.abs(i)<b){u=0;a=0}else{u=Math.log(b/Math.abs(i))/Math.log(y);a=i*(1-Math.pow(y,u+1))/(1-y)}f=Math.floor(qt[n]+a);if(!wt.bouncing){if(qt[n]===0&&f>0){f=0}else if(qt[n]===Lt.scrollEnd[n]&&f<qt[n]){f=qt[n]}}if(wt.paginatedSnap&&wt.snapping){E=-qt[n]/At[n];if(Mt[n]<E){E=Math.floor(E)}else{E=Math.ceil(E)}if(f>-(E-1)*At[n]){c=f+(E-1)*At[n]}else if(f<-(E+1)*At[n]){c=f+(E+1)*At[n]}else if(Math.abs(i)>b){if(i<0){f=Math.floor(qt[n]/At[n])*At[n]}else{f=Math.ceil(qt[n]/At[n])*At[n]}u=Math.min(wt.maxFlingDuration,u*(f-qt[n])/a)}}else if(wt.snapping){c=f-Math.round(f/At[n])*At[n]}if(f-c>0){c=f;d=true}else if(f-c<Lt.scrollEnd[n]){c=f-Lt.scrollEnd[n];d=true}if(c){if(d&&wt.bouncing&&a){a=Math.floor(a);if(f>0){S=f-Math.max(0,qt[n])}else{S=f-Math.min(Lt.scrollEnd[n],qt[n])}x=a-S;if(!a||!u){g=0}else{g=m._getCoordinateForT(m.getTForY((a-S)/a,1/u),m._p1.x,m._p2.x);w=g*u}v=Math.ceil(S/8);if(Math.abs(v)>Lt.container[n]/2){if(v<0){v=-Math.floor(Lt.container[n]/2)}else{v=Math.floor(Lt.container[n]/2)}}if(f>0){p=0}else{p=Lt.scrollEnd[n]}if(g===0){u=u/6;f=qt[n]+x+v;l=u}else{l=(g+(1-g)/6)*u;K(n,qt[n]+x+v,(1-g)*u/6,wt.bounceDecelerationBezier,w);m=m.divideAtX(l/u,1/u)[0];u=l;f=qt[n]+x+v}}else if(a<0&&c<a||a>0&&c>a){f=f-Math.floor(a/2);c=c-Math.floor(a/2);h=Math.sqrt(Math.abs(c))*50;p=f-c;u=350;l=u*.97}else{f=f-c;if(!a){u=h}else if(a<0&&c<0||a>0&&c>0){g=m._getCoordinateForT(m.getTForY((Math.abs(a)-Math.abs(c))/Math.abs(a),1/u),m._p1.x,m._p2.x);m=m.divideAtX(g,1/u)[0];u=Math.round(u*g)}c=0;h=0}}if(f===qt[n]&&!c){continue}N=true;$(n,f,u,m,w);if(c&&h){K(n,p,h,wt.bounceBezier,l)}T=Math.max(T,c?l+h:u);C[n]=p===false?f:p}}if(N&&T){Wt.push(setTimeout(function(){var e;for(e in C){if(C.hasOwnProperty(e)){qt[e]=C[e]}}_()},T))}return N};H=function(t){var n;var r=t?100:350;var i=qt;if(wt.snapping){Ot=j(i);i=B(Ot,i)}i=I(i);var s=false;for(n in Vt){if(Vt.hasOwnProperty(n)){if(i[n]!==qt[n]){s=true}}}if(!s){return false}for(n in Vt){if(Vt.hasOwnProperty(n)){$(n,i[n],r)}}Wt.push(setTimeout(function(){qt=i;_(t)},r));return true};j=function(t){var n;var r={x:0,y:0};for(n in $t){if($t.hasOwnProperty(n)&&At[n]){r[n]=Math.round(t[n]/At[n])}}return r};B=function(t,n){var r;var i={x:n.x,y:n.y};for(r in $t){if($t.hasOwnProperty(r)){i[r]=t[r]*At[r]}}return i};F=function(){var t;for(t in $t){if($t.hasOwnProperty(t)){if(Rt[t]>0){Rt[t]=Y(Rt[t],t)}else if(Rt[t]<Lt.scrollEnd[t]){Rt[t]=Lt.scrollEnd[t]+Y(Rt[t]-Lt.scrollEnd[t],t)}}}if(!en){tt()}};I=function(t){var n;var r={x:t.x,y:t.y};for(n in $t){if($t.hasOwnProperty(n)){if(t[n]>0){r[n]=0;continue}if(t[n]<Lt.scrollEnd[n]){r[n]=Lt.scrollEnd[n];continue}}}return r};q=function(){var t,n,r;if(R()){return}t=xt.ownerDocument.createDocumentFragment();n=document.createElement("DIV");t.appendChild(n);n.innerHTML=FTScroller.prototype.getPrependedHTML(!wt.scrollingX,!wt.scrollingY,wt.hwAccelerationClass)+FTScroller.prototype.getAppendedHTML(!wt.scrollingX,!wt.scrollingY,wt.hwAccelerationClass,wt.scrollbars);Tt=n.firstElementChild;r=Tt;if(wt.scrollingX){Ct.x=Tt.firstElementChild;r=Ct.x;if(wt.scrollbars){kt.x=Tt.getElementsByClassName("ftscroller_scrollbarx")[0]}}if(wt.scrollingY){Ct.y=r.firstElementChild;if(wt.scrollbars){kt.y=Tt.getElementsByClassName("ftscroller_scrollbary")[0]}Nt=Ct.y}else{Nt=Ct.x}while(xt.firstChild){Nt.appendChild(xt.firstChild)}xt.appendChild(Tt)};R=function(){var t,n,r,i,s,o,u,a,f;t=xt.firstElementChild;if(!t||t.className.indexOf("ftscroller_container")===-1){return}if(wt.scrollingX){n=t.firstElementChild;if(!n||n.className.indexOf("ftscroller_x")===-1){return}i=n;if(wt.scrollbars){u=t.getElementsByClassName("ftscroller_scrollbarx");if(u){for(a=0,f=u.length;a<f;a=a+1){if(u[a].parentNode===t){s=u[a];break}}}if(!s){return}}}else{i=t}if(wt.scrollingY){r=i.firstElementChild;if(!r||r.className.indexOf("ftscroller_y")===-1){return}if(wt.scrollbars){u=t.getElementsByClassName("ftscroller_scrollbary");if(u){for(a=0,f=u.length;a<f;a=a+1){if(u[a].parentNode===t){o=u[a];break}}}if(!o){return}}}Tt=t;if(n){Ct.x=n}if(r){Ct.y=r}if(s){kt.x=s}if(o){kt.y=o}if(wt.scrollingY){Nt=r}else{Nt=n}return true};U=function(t){if(Gt){window.clearTimeout(Gt)}if(t&&t.type==="resize"){z()}else{Gt=setTimeout(function(){z()},100)}};z=function(t){var n;if(!Tt||!Nt){return false}if(Gt){window.clearTimeout(Gt);Gt=false}var r,i,s;s={x:false,y:false};for(n in s){if(s.hasOwnProperty(n)){if(qt[n]===0){s[n]=-1}else if(qt[n]<=Lt.scrollEnd[n]){s[n]=1}else if(qt[n]*2<=Lt.scrollEnd[n]+5&&qt[n]*2>=Lt.scrollEnd[n]-5){s[n]=0}}}r=Tt.offsetWidth;i=Tt.offsetHeight;var o=w.contentWidth||Nt.offsetWidth;var u=w.contentHeight||Nt.offsetHeight;var a=o;var f=u;var l={x:qt.x,y:qt.y};if(!At.userX){At.x=r}if(!At.userY){At.y=i}if(wt.snapping){if(At.userX){a=Math.ceil(a/At.userX)*At.userX}else{a=Math.ceil(a/At.x)*At.x}if(At.userY){f=Math.ceil(f/At.userY)*At.userY}else{f=Math.ceil(f/At.y)*At.y}}if(Lt.container.x===r&&Lt.container.y===i&&Lt.content.x===a&&Lt.content.y===f){return}Lt.container.x=r;Lt.container.y=i;Lt.content.x=a;Lt.content.rawX=o;Lt.content.y=f;Lt.content.rawY=u;Lt.scrollEnd.x=r-a;Lt.scrollEnd.y=i-f;W();if(Bt){qt.x--;qt.y--;F()}else{if(!t&&wt.snapping){V();l=B(Ot,qt)}for(n in l){if(l.hasOwnProperty(n)){if(Lt.container[n]<Lt.content[n]){if(Xt&&wt.baseAlignments[n]!==s[n]){continue}}if(wt.baseAlignments[n]===1){l[n]=Lt.scrollEnd[n]}else if(wt.baseAlignments[n]===0){l[n]=Math.floor(Lt.scrollEnd[n]/2)}else if(wt.baseAlignments[n]===-1){l[n]=0}}}l=I(l);if(wt.scrollingX&&l.x!==qt.x){$("x",l.x,0);It.x=l.x}if(wt.scrollingY&&l.y!==qt.y){$("y",l.y,0);It.y=l.y}}};W=function(){if(wt.scrollbars){if(wt.scrollingX){kt.x.style.width=Math.max(6,Math.round(Lt.container.x*(Lt.container.x/Lt.content.x)-4))+"px"}if(wt.scrollingY){kt.y.style.height=Math.max(6,Math.round(Lt.container.y*(Lt.container.y/Lt.content.y)-4))+"px"}}$t={};if(wt.scrollingX&&(Lt.content.x>Lt.container.x||wt.alwaysScroll)){$t.x=true}if(wt.scrollingY&&(Lt.content.y>Lt.container.y||wt.alwaysScroll)){$t.y=true}};X=function(){var t,r,i;for(t in $t){if($t.hasOwnProperty(t)){r=window.getComputedStyle(Ct[t],null)[n];i=r.split(", ");if(i.length===6){It[t]=parseInt(i[t==="y"?5:4],10)}else{It[t]=parseInt(i[t==="y"?13:12],10)}qt[t]=It[t]}}};V=function(t){var n;var r={x:0,y:0};if(!wt.snapping){return}for(n in $t){if($t.hasOwnProperty(n)){r[n]=Math.max(0,Math.min(Math.ceil(Lt.content[n]/At[n])-1,Math.round(-qt[n]/At[n])))}}if(r.x!==_t.x||r.y!==_t.y){_t.x=r.x;_t.y=r.y;Q("segmentwillchange",{segmentX:r.x,segmentY:r.y})}if(t){if(r.x!==Mt.x||r.y!==Mt.y){Mt.x=r.x;Mt.y=r.y;Q("segmentdidchange",{segmentX:r.x,segmentY:r.y})}}};$=function(n,r,i,s,o){var u,a=null;if(!Ct[n]){return false}if(i){if(!s){s=wt.flingBezier}u=e+"transform "+i+"ms "+s.toString()}else{u=""}Ct[n].style[d]=u;if(wt.scrollbars){kt[n].style[d]=u}Ct[n].style[p]=v+m[n]+r+"px"+g[n];if(wt.scrollbars){kt[n].style[p]=v+m[n]+ -r*Lt.container[n]/Lt.content[n]+"px"+g[n]}if(r>=0){a="start"}else if(r<=Lt.scrollEnd[n]){a="end"}if(a!==Ut[n]){if(a!==null){if(i){Wt.push(setTimeout(function(){Q("reached"+a,{axis:n})},o||i))}else{Q("reached"+a,{axis:n})}}Ut[n]=a}if(!i){qt[n]=r}};J=function(){return{scrollLeft:-qt.x,scrollTop:-qt.y}};K=function(t,n,r,i,s){Wt.push(setTimeout(function(){$(t,n,r,i)},s))};Q=function(t,n){var r,i;n.srcObject=Et;for(r=0,i=nn[t].length;r<i;r=r+1){try{nn[t][r](n)}catch(s){if(window.console&&window.console.error){if(s.message){window.console.error(s.message+" ("+s.sourceURL+", line "+s.line+")")}else{window.console.error("Error encountered executing FTScroller event listener callback for ["+t+']. Add a "debugger" statement here to obtain a full backtrace.');if(window.console.dir)window.console.dir(s)}}}}};G=function(t){var n,r,i;var s=bt(t.target);var o=bt(Tt);var u={x:"left",y:"top"};var a={x:"right",y:"bottom"};var f={x:"width",y:"height"};if(Dt!==false){return}for(r in $t){if($t.hasOwnProperty(r)){if(s[u[r]]>=o[u[r]]&&s[a[r]]<=o[a[r]]){continue}if(s[f[r]]>o[f[r]]){i=s[f[r]]-Math.max(0,o[u[r]]-s[u[r]])-Math.max(0,s[a[r]]-o[a[r]]);if(i>=o[f[r]]/2){continue}}n=-Math.round(s[f[r]]/2-qt[r]+s[u[r]]-o[u[r]]-o[f[r]]/2);n=Math.min(0,Math.max(Lt.scrollEnd[r],n));$(r,n,0);It[r]=n}}Q("scroll",J())};Y=function(t,n){if(!wt.bouncing){return 0}var r=Math.exp(t/Lt.container[n]);return Math.round(Lt.container[n]*.6*(r-1)/(r+1))};Z=function(t){var n,r;var i={};for(n in t){if(t.hasOwnProperty(n)){r=t[n];if(r>=0){i[n]=r}else if(r>Lt.scrollEnd[n]){i[n]=-1}else{i[n]=Lt.scrollEnd[n]-r}}}return i};et=function(){if(en){nt();Zt=en(tt)}};tt=function sn(){var e,t;if(en){Zt=en(sn)}for(e in $t){if($t.hasOwnProperty(e)&&Rt[e]!==qt[e]){$(e,Rt[e]);t=true}}if(Bt&&t){Q("scroll",J());V(false)}};nt=function(){if(Zt===false||!tn){return}tn(Zt);Zt=false};rt=function(n){var i;if(!Tt){return}if(n){Tt._ftscrollerToggle=Tt.addEventListener}else{Tt._ftscrollerToggle=Tt.removeEventListener}if(u){if(r){Tt._ftscrollerToggle("MSPointerDown",lt,true);Tt._ftscrollerToggle("MSPointerMove",ct,true);Tt._ftscrollerToggle("MSPointerUp",ht,true);Tt._ftscrollerToggle("MSPointerCancel",pt,true)}else{Tt._ftscrollerToggle("pointerdown",lt,true);Tt._ftscrollerToggle("pointermove",ct,true);Tt._ftscrollerToggle("pointerup",ht,true);Tt._ftscrollerToggle("pointercancel",pt,true)}}else{if(l&&!wt.disabledInputMethods.touch){Tt._ftscrollerToggle("touchstart",it,true);Tt._ftscrollerToggle("touchmove",st,true);Tt._ftscrollerToggle("touchend",ot,true);Tt._ftscrollerToggle("touchcancel",ot,true)}if(!wt.disabledInputMethods.mouse){Tt._ftscrollerToggle("mousedown",ut,true);if(!n){document.removeEventListener("mousemove",at,true);document.removeEventListener("mouseup",ft,true)}}}if(!wt.disabledInputMethods.scroll){Tt._ftscrollerToggle("DOMMouseScroll",mt,false);Tt._ftscrollerToggle("mousewheel",mt,false)}if(u){if(n){document.addEventListener("click",vt,true)}else{document.removeEventListener("click",vt,true)}}else{Tt._ftscrollerToggle("click",vt,true)}if(n){Nt.addEventListener("focus",G,true);if(wt.updateOnChanges){if(!rn){i=window.MutationObserver||window.WebKitMutationObserver||window[t+"MutationObserver"];if(i){rn=new i(U)}}if(rn){rn.observe(Nt,{childList:true,characterData:true,subtree:true})}else{Nt.addEventListener("DOMSubtreeModified",function(e){if(e&&(e.srcElement===Nt||e.srcElement.className.indexOf("ftscroller_")!==-1)){return}U()},true)}Nt.addEventListener("load",U,true)}if(wt.updateOnWindowResize){window.addEventListener("resize",U,true)}}else{Nt.removeEventListener("focus",G,true);if(rn){rn.disconnect()}else{Nt.removeEventListener("DOMSubtreeModified",U,true)}Nt.removeEventListener("load",U,true);window.removeEventListener("resize",U,true)}delete Tt._ftscrollerToggle};it=function(t){var n,r,i;if(Dt){for(n=0,r=t.touches.length;n<r;n=n+1){if(t.touches[n].identifier===Dt){Pt=n}}return}i=t.touches[0];Dt=i.identifier;Pt=0;A(i.clientX,i.clientY,t.timeStamp,t)};st=function(t){if(Dt===false){return}var n=t.touches[Pt];O(n.clientX,n.clientY,t.timeStamp,t)};ot=function(t){var n,r;if(t.touches){for(n=0,r=t.touches.length;n<r;n=n+1){if(t.touches[n].identifier===Dt){Pt=n;return}}}M(t.timeStamp,t)};ut=function(t){if(t.button&&t.button===2||t.ctrlKey){return}if(Tt.setCapture){Tt.setCapture()}document.addEventListener("mousemove",at,true);document.addEventListener("mouseup",ft,true);Dt=t.button||1;Pt=0;A(t.clientX,t.clientY,t.timeStamp,t)};at=function(t){if(!Dt){return}O(t.clientX,t.clientY,t.timeStamp,t)};ft=function on(e){if(e.button&&e.button!==Dt){return}document.removeEventListener("mousemove",at,true);document.removeEventListener("mouseup",on,true);if(Tt.releaseCapture){Tt.releaseCapture()}M(e.timeStamp,e)};lt=function(t){if(Dt){return}if(t.pointerType===a){if(wt.disabledInputMethods.touch){return}}else if(wt.disabledInputMethods.mouse){return}Dt=t.pointerId;A(t.clientX,t.clientY,t.timeStamp,t)};ct=function(t){if(Dt!==t.pointerId){return}O(t.clientX,t.clientY,t.timeStamp,t)};ht=function(t){if(Dt!==t.pointerId){return}M(t.timeStamp,t)};pt=function(t){M(t.timeStamp,t)};dt=function(t){Ht=false};vt=function(t){if(!zt&&!Dt){return true}t.preventDefault();t.stopPropagation();if(!Dt){zt=false}return false};mt=function(t){var n,r;if(Dt!=="scrollwheel"){if(Dt!==false){return true}Dt="scrollwheel";Kt.x=0;Kt.y=0;if(!A(t.clientX,t.clientY,Date.now(),t)){return}}if(t.wheelDelta){if(t.wheelDeltaX){n=t.wheelDeltaX/2;r=t.wheelDeltaY/2}else{n=0;r=t.wheelDelta/2}}else{if(t.axis&&t.axis===t.HORIZONTAL_AXIS){n=t.detail*-10;r=0}else{n=0;r=t.detail*-10}}if(!wt.scrollingY&&!n){n=r;r=0}Kt.x=Math.round(Kt.x+n);Kt.y=Math.round(Kt.y+r);O(Jt.x+Kt.x,Jt.y+Kt.y,t.timeStamp,t);if(Yt){clearTimeout(Yt)}Yt=setTimeout(function(){yt();Dt=false;Bt=false;jt=false;f=false;if(wt.windowScrollingActiveFlag){window[wt.windowScrollingActiveFlag]=false}nt();if(!H()){_()}},300)};gt=function(){if(Ht||Dt===false||Dt==="scrollwheel"){return}if(u){Tt[i](Dt);Tt.addEventListener(o,dt,false)}Ht=true};yt=function(){if(!Ht){return}if(u){Tt.removeEventListener(o,dt,false);Tt[s](Dt)}Ht=false};bt=function(t){if(t.getBoundingClientRect){return t.getBoundingClientRect()}var n=0,r=0,i=t;while(i){n=n+i.offsetLeft-i.scrollLeft;r=r+i.offsetTop-i.scrollTop;i=i.offsetParent}return{left:n,top:r,width:t.offsetWidth,height:t.offsetHeight}};q();z();rt(true);Et={destroy:S,setSnapSize:x,scrollTo:T,scrollBy:N,updateDimensions:C,addEventListener:k,removeEventListener:L};if(Object.defineProperties){Object.defineProperties(Et,{scrollHeight:{get:function(){return Lt.content.y},set:function(e){throw new SyntaxError("scrollHeight is currently read-only - ignoring "+e)}},scrollLeft:{get:function(){return-qt.x},set:function(e){T(e,false,false);return-qt.x}},scrollTop:{get:function(){return-qt.y},set:function(e){T(false,e,false);return-qt.y}},scrollWidth:{get:function(){return Lt.content.x},set:function(e){throw new SyntaxError("scrollWidth is currently read-only - ignoring "+e)}},segmentCount:{get:function(){if(!wt.snapping){return{x:NaN,y:NaN}}return{x:Math.ceil(Lt.content.x/At.x),y:Math.ceil(Lt.content.y/At.y)}},set:function(e){throw new SyntaxError("segmentCount is currently read-only - ignoring "+e)}},currentSegment:{get:function(){return{x:_t.x,y:_t.y}},set:function(e){throw new SyntaxError("currentSegment is currently read-only - ignoring "+e)}},contentContainerNode:{get:function(){return Nt},set:function(e){throw new SyntaxError("contentContainerNode is currently read-only - ignoring "+e)}}})}return Et};FTScroller.prototype.getPrependedHTML=function(e,t,n){if(!n){if(typeof FTScrollerOptions==="object"&&FTScrollerOptions.hwAccelerationClass){n=FTScrollerOptions.hwAccelerationClass}else{n="ftscroller_hwaccelerated"}}var r='<div class="ftscroller_container">';if(!e){r+='<div class="ftscroller_x '+n+'">'}if(!t){r+='<div class="ftscroller_y '+n+'">'}return r};FTScroller.prototype.getAppendedHTML=function(e,t,n,r){if(!n){if(typeof FTScrollerOptions==="object"&&FTScrollerOptions.hwAccelerationClass){n=FTScrollerOptions.hwAccelerationClass}else{n="ftscroller_hwaccelerated"}}var i="";if(!e){i+="</div>"}if(!t){i+="</div>"}if(r){if(!e){i+='<div class="ftscroller_scrollbar ftscroller_scrollbarx '+n+'"><div class="ftscroller_scrollbarinner"></div></div>'}if(!t){i+='<div class="ftscroller_scrollbar ftscroller_scrollbary '+n+'"><div class="ftscroller_scrollbarinner"></div></div>'}}i+="</div>";return i}})();(function(){"use strict";function e(e,t){throw new RangeError('"'+e+'" must be a number between 0 and 1. '+"Got "+t+" instead.")}CubicBezier=function(t,n,r,i){if(!(t>=0&&t<=1)){e("p1x",t)}if(!(n>=0&&n<=1)){e("p1y",n)}if(!(r>=0&&r<=1)){e("p2x",r)}if(!(i>=0&&i<=1)){e("p2y",i)}this._p1={x:t,y:n};this._p2={x:r,y:i}};CubicBezier.prototype._getCoordinateForT=function(e,t,n){var r=3*t,i=3*(n-t)-r,s=1-r-i;return((s*e+i)*e+r)*e};CubicBezier.prototype._getCoordinateDerivateForT=function(e,t,n){var r=3*t,i=3*(n-t)-r,s=1-r-i;return(3*s*e+2*i)*e+r};CubicBezier.prototype._getTForCoordinate=function(e,t,n,r){if(!isFinite(r)||r<=0){throw new RangeError('"epsilon" must be a number greater than 0.')}var i,s,o,u;for(i=e,s=0;s<8;s=s+1){o=this._getCoordinateForT(i,t,n)-e;if(Math.abs(o)<r){return i}u=this._getCoordinateDerivateForT(i,t,n);if(Math.abs(u)<1e-6){break}i=i-o/u}i=e;var a=0,f=1;if(i<a){return a}if(i>f){return f}while(a<f){o=this._getCoordinateForT(i,t,n);if(Math.abs(o-e)<r){return i}if(e>o){a=i}else{f=i}i=(f-a)*.5+a}return i};CubicBezier.prototype.getPointForT=function(t){if(t===0||t===1){return{x:t,y:t}}if(t<0||t>1){e("t",t)}return{x:this._getCoordinateForT(t,this._p1.x,this._p2.x),y:this._getCoordinateForT(t,this._p1.y,this._p2.y)}};CubicBezier.prototype.getTForX=function(e,t){return this._getTForCoordinate(e,this._p1.x,this._p2.x,t)};CubicBezier.prototype.getTForY=function(e,t){return this._getTForCoordinate(e,this._p1.y,this._p2.y,t)};CubicBezier.prototype._getAuxPoints=function(t){if(t<=0||t>=1){e("t",t)}var n={x:t*this._p1.x,y:t*this._p1.y},r={x:this._p1.x+t*(this._p2.x-this._p1.x),y:this._p1.y+t*(this._p2.y-this._p1.y)},i={x:this._p2.x+t*(1-this._p2.x),y:this._p2.y+t*(1-this._p2.y)};var s={x:n.x+t*(r.x-n.x),y:n.y+t*(r.y-n.y)},o={x:r.x+t*(i.x-r.x),y:r.y+t*(i.y-r.y)};var u={x:s.x+t*(o.x-s.x),y:s.y+t*(o.y-s.y)};return{i0:n,i1:r,i2:i,j0:s,j1:o,k:u}};CubicBezier.prototype.divideAtT=function(t){if(t<0||t>1){e("t",t)}if(t===0||t===1){var n=[];n[t]=CubicBezier.linear();n[1-t]=this.clone();return n}var r={},i={},s=this._getAuxPoints(t);var o=s.i0,u=s.i2,a=s.j0,f=s.j1,l=s.k;var c=l.x,h=l.y;r.p1={x:o.x/c,y:o.y/h};r.p2={x:a.x/c,y:a.y/h};i.p1={x:(f.x-c)/(1-c),y:(f.y-h)/(1-h)};i.p2={x:(u.x-c)/(1-c),y:(u.y-h)/(1-h)};return[new CubicBezier(r.p1.x,r.p1.y,r.p2.x,r.p2.y),new CubicBezier(i.p1.x,i.p1.y,i.p2.x,i.p2.y)]};CubicBezier.prototype.divideAtX=function(t,n){if(t<0||t>1){e("x",t)}var r=this.getTForX(t,n);return this.divideAtT(r)};CubicBezier.prototype.divideAtY=function(t,n){if(t<0||t>1){e("y",t)}var r=this.getTForY(t,n);return this.divideAtT(r)};CubicBezier.prototype.clone=function(){return new CubicBezier(this._p1.x,this._p1.y,this._p2.x,this._p2.y)};CubicBezier.prototype.toString=function(){return"cubic-bezier("+[this._p1.x,this._p1.y,this._p2.x,this._p2.y].join(", ")+")"};CubicBezier.linear=function(){return new CubicBezier};CubicBezier.ease=function(){return new CubicBezier(.25,.1,.25,1)};CubicBezier.linear=function(){return new CubicBezier(0,0,1,1)};CubicBezier.easeIn=function(){return new CubicBezier(.42,0,1,1)};CubicBezier.easeOut=function(){return new CubicBezier(0,0,.58,1)};CubicBezier.easeInOut=function(){return new CubicBezier(.42,0,.58,1)}})();var module;if(module!==undefined&&module.exports){module.exports=function(e,t){"use strict";return new FTScroller(e,t)};module.exports.FTScroller=FTScroller;module.exports.CubicBezier=CubicBezier}
